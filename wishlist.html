<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" href="img/letter-c.png" type="image/icon type">
    <title>Cara</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <section id="header">
        <a href="#"> <img src="img/logo.png" class="logo" alt=""></a>
        <!-- <h4>seven style</h4> -->

        <div>
            <ul id="navbar">
                <li><a href="index.html">Home</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li id="lg-bag"><a class="active" href="wishlist.html"><i class='fas fa-heart fa-lg'
                            style="color: rgb(255, 81, 81);"></i></a></li>
                <li id="lg-bag"><a href="cart.html"><i class="fa-solid fa-bag-shopping fa-lg"></i></a></li>
                <li id="lg-bag"><a href="user.html"><i class="far fa-circle-user fa-lg"></i></a></li>
                <i class="fa-solid fa-xmark fa-lg" id="close"></i>
            </ul>
        </div>

        <div id="mobile">
            <a href="cart.html"><i class="fa-solid fa-bag-shopping fa-lg"></i></a>
            <a href="wishlist.html"><i class='far fa-heart fa-lg' style="color: rgb(255, 81, 81);"></i></a>
            <a href="user.html"><i class="far fa-circle-user fa-lg"></i></a>
            <i class="fas fa-outdent fa-lg" id="bar"></i>
        </div>

    </section>

    <section id="page-header" class="wishli-header">
        <h2>#Wishlist</h2>
        <p>Add your favourite item</p>
    </section>

    <section id="wishlist" class="section-p1 wish">
        <h2 style="text-align: center; font-size: 30px;">My Wishlist</h2>
        <table id="wishlistTable" width="100%">
            <thead>
                <tr>
                    <td>Remove</td>
                    <td>Image</td>
                    <td>Product</td>
                    <td>Price</td>
                    <td>Add to Cart</td>
                </tr>
            </thead>
            <tbody id="wishlistTableBody">
                <!-- Wishlist items will be dynamically added here -->
            </tbody>
        </table>
        <div id="empty" style="display: none;">
            <div id="empty-cart" class="empty-container">
                <div class="cart-blank"></div>
                <div class="empty-cart">
                    <p id="emptyCartMessage">
                    <h3>Your wishlist needs some love.</h3>
                    <span>Fill your wishlist with your favorite items from Cara.</span>
                    </p>
                    <button id="startShoppingButton" class="button-85" role="button"
                        onclick="window.location.href='index.html';">Start Shopping</button>
                </div>
            </div>
        </div>
    </section>


    <section id="additional-info">
        <div class="info-item">
            <i class="fas fa-check-circle"></i>
            <h4>Authentic Products</h4>
        </div>

        <div class="info-item">
            <i class="fas fa-store"></i>
            <h4>Express Store Pickup</h4>
        </div>

        <div class="info-item">
            <i class="fas fa-shield-alt"></i>
            <h4>Secure Payment</h4>
        </div>

        <div class="info-item">
            <i class="fas fa-exchange-alt"></i>
            <h4>Easy Return and Exchange</h4>
        </div>

        <div class="info-menu">
            <select id="brandsDropdown" onchange="redirectToPage(this)">
                <option value="" disabled selected>Select a Brand</option>
                <option value="puma">Puma</option>
                <option value="zara">Zara</option>
                <option value="adidas">Adidas</option>
            </select>
        </div>
    </section>

    <section id="newsletter">
        <div id="newsletters" class="section-p1 section-m1">
            <div class="newstext">
                <h4>Sign Up For newsletters</h4>
                <p>Get E-mail updates about our latest shop and <span> special offers. </span></p>
                <p>If you have already signed up then <button class="a" id="loginButton">Login</button></p>
            </div>
            <div class="form">
                <input type="text" name="" id="" placeholder="Your Email Adress" required>
                <button class="normal" id="signup">Sign Up</button>
            </div>
            <div id="popupBox" class="popup">
                <h4 id="popupMessage"></h4>
            </div>
        </div>
    </section>

    <footer class="section-p1">
        <div class="col">
            <img class="logo" src="img/logo.png" alt="">
            <h4>Contact</h4>
            <p><strong>Adress: </strong> Nana Varachha Surat</p>
            <p><strong>Phone: </strong> +91 7862989487 / +91 9426056690</p>
            <p><strong>Hours: </strong>Online 24/7 - Offline 09:00am - 10:00pm, Mon - Sat</p>
            <div class="follow">
                <h4>Follow Us</h4>
                <div class="icon">
                    <i class="fab fa-facebook-f"></i>
                    <i class="fab fa-twitter"></i>
                    <i class="fab fa-instagram"></i>
                    <i class="fab fa-telegram"></i>
                    <i class="fab fa-youtube"></i>
                </div>
            </div>
        </div>

        <div class="col">
            <h4>About</h4>
            <a href="#">About Us</a>
            <a href="#">Delivery Information</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms & Conditions</a>
            <a href="#">Contact Us</a>
        </div>

        <div class="col">
            <h4>My Account</h4>
            <a href="#">Sign In</a>
            <a href="#">View Cart</a>
            <a href="#">My Wishlist</a>
            <a href="#">Track My Order</a>
            <a href="#">Help</a>
        </div>

        <div class="col install">
            <h4>Install App</h4>
            <p>From App Store or Google Play</p>
            <div class="row">
                <img src="img/pay/app.jpg" alt="">
                <img src="img/pay/play.jpg" alt="">
            </div>
            <p>Secured Payment Gateways</p>
            <img src="img/pay/pay.png" alt="">
        </div>

        <div class="copyright">
            <p><i class="fa-solid fa-copyright fa-lg"></i> 2023, Cara.com - Clothes That Never Go Out Of Style. All
                rights reserved </p>
            <p><a href="#">Terms of Use </a> | <a href="#">Cookie & Privacy Policy</a></p>
        </div>
    </footer>

    <script>
         function getwishContents() {
            const wishItems = JSON.parse(localStorage.getItem('wishlist')) || [];
            return wishItems;
        }

        function updatewishDisplay() {
            const wishlistTableBody = document.getElementById("wishlistTableBody");
            const empty = document.getElementById("empty");

            const wishContents = getwishContents();
            if (wishContents.length === 0) {
                wishlistTableBody.style.display = "none";
                empty.style.display = "block";
            } else {
                wishlistTableBody.style.display = "table-row-group";
                empty.style.display = "none";
            }
        }

        updatewishDisplay();
        document.addEventListener("DOMContentLoaded", () => {
            const username = localStorage.getItem("username");
            const loginButton = document.getElementById("loginButton");
            const signup = document.getElementById("signup");
            const popupBox = document.getElementById("popupBox");
            const popupMessage = document.getElementById("popupMessage");
            const newslettersSection = document.getElementById("newsletter");

            if (loginButton) {
                loginButton.addEventListener("click", () => {
                    if (username !== null) {
                        localStorage.setItem("shouldShowPopup", "true");
                    } else {
                        window.location.href = "login.html";
                    }
                });
            }

            if (signup) {
                signup.addEventListener("click", () => {
                    if (username !== null) {
                        localStorage.setItem("shouldShowPopup", "true");
                    } else {
                        window.location.href = "login.html";
                    }
                });
            }

            if (localStorage.getItem("shouldShowPopup") === "true" && username !== null && window.location.href.includes("index.html")) {
                localStorage.removeItem("shouldShowPopup");
                showPopup();

                const formattedUsername = username.charAt(0).toUpperCase() + username.slice(1).toLowerCase();
                const spanElement = document.createElement("span");
                spanElement.textContent = formattedUsername;
                spanElement.classList.add("username-span");

                popupMessage.innerHTML = `Welcome ${spanElement.outerHTML}, You are Already Logged in at Cara.com.`;

                setTimeout(() => {
                    popupBox.style.display = "none";
                }, 2000);
            }

            if (username !== null) {
                newslettersSection.style.display = "none";
            } else {
                newslettersSection.style.display = "block";
            }

            function showPopup() {
                popupBox.style.display = "block";
            }
        });
        function addToWishlist(name, price, imageSrc) {
            let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            wishlist.push({
                name: name,
                price: price,
                imageSrc: imageSrc
            });
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            console.log('Product added to wishlist:', { name, price, imageSrc });
            updateWishlistTable();
        }

        function removeFromWishlist(index) {
            let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            wishlist.splice(index, 1);
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            updateWishlistTable();
        }
        function updateCartTable() {
            const cartTableBody = document.querySelector('#cart tbody');
            cartTableBody.innerHTML = '';

            let cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            cartItems.forEach(item => {
                const row = cartTableBody.insertRow();

                // Add cells and populate them with item details (similar to wishlist table)
            });
        }

        // Function to update the wishlist table
        function updateWishlistTable() {
            const wishlistTableBody = document.getElementById('wishlistTableBody');
            wishlistTableBody.innerHTML = '';

            let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            wishlist.forEach((item, index) => {
                const row = wishlistTableBody.insertRow();

                const removeCell = row.insertCell(0);
                const removeIcon = document.createElement('i');
                removeIcon.classList.add('fas', 'fa-trash-can', 'fa-xl');
                removeCell.appendChild(removeIcon);
                removeCell.addEventListener('click', () => {
                    removeFromWishlist(index);
                    row.remove();
                });

                const imageCell = row.insertCell(1);
                const image = document.createElement('img');
                image.src = item.imageSrc;
                image.alt = item.name;
                imageCell.appendChild(image);

                const productCell = row.insertCell(2);
                productCell.textContent = item.name;

                const priceCell = row.insertCell(3);
                priceCell.textContent = item.price;

                const addToCartCell = row.insertCell(4);
                const addToCartIcon = document.createElement('i');
                addToCartIcon.classList.add('fas', 'fa-cart-plus', 'fa-xl');
                addToCartCell.appendChild(addToCartIcon);   
                addToCartCell.addEventListener('click', () => {
                    let cartItems = JSON.parse(localStorage.getItem('cart')) || [];

                    // Define the data you want to store
                    let pr = item.price;
                    const cartItem = {
                        name: item.name,
                        price:parseInt(pr.substring(3)),
                        size: "Small",
                        quantity: 1,
                        image: item.imageSrc,
                        cartSubtotal:item.price*item.quantity
                    };

                    cartItems.push(cartItem);
                    localStorage.setItem('cart', JSON.stringify(cartItems));

                    window.location.href = 'cart.html';
                });
            });
        }

        // Initial load
        updateWishlistTable();

    </script>

    <script src="script.js"></script>
</body>

</html>